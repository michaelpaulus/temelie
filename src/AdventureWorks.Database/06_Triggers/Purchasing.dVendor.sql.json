{
  "triggerName": "dVendor",
  "schemaName": "Purchasing",
  "definition": "CREATE TRIGGER [Purchasing].[dVendor] ON [Purchasing].[Vendor] \nINSTEAD OF DELETE NOT FOR REPLICATION AS \nBEGIN\n    DECLARE @Count int;\n\n    SET @Count = @@ROWCOUNT;\n    IF @Count = 0 \n        RETURN;\n\n    SET NOCOUNT ON;\n\n    BEGIN TRY\n        DECLARE @DeleteCount int;\n\n        SELECT @DeleteCount = COUNT(*) FROM deleted;\n        IF @DeleteCount > 0 \n        BEGIN\n            RAISERROR\n                (N'Vendors cannot be deleted. They can only be marked as not active.', -- Message\n                10, -- Severity.\n                1); -- State.\n\n        -- Rollback any active or uncommittable transactions\n            IF @@TRANCOUNT > 0\n            BEGIN\n                ROLLBACK TRANSACTION;\n            END\n        END;\n    END TRY\n    BEGIN CATCH\n        EXECUTE [dbo].[uspPrintError];\n\n        -- Rollback any active or uncommittable transactions before\n        -- inserting information in the ErrorLog\n        IF @@TRANCOUNT > 0\n        BEGIN\n            ROLLBACK TRANSACTION;\n        END\n\n        EXECUTE [dbo].[uspLogError];\n    END CATCH;\nEND;",
  "tableName": "Vendor"
}