{
  "triggerName": "uWorkOrder",
  "schemaName": "Production",
  "definition": "CREATE TRIGGER [Production].[uWorkOrder] ON [Production].[WorkOrder] \nAFTER UPDATE AS \nBEGIN\n    DECLARE @Count int;\n\n    SET @Count = @@ROWCOUNT;\n    IF @Count = 0 \n        RETURN;\n\n    SET NOCOUNT ON;\n\n    BEGIN TRY\n        IF UPDATE([ProductID]) OR UPDATE([OrderQty])\n        BEGIN\n            INSERT INTO [Production].[TransactionHistory](\n                [ProductID]\n                ,[ReferenceOrderID]\n                ,[TransactionType]\n                ,[TransactionDate]\n                ,[Quantity])\n            SELECT \n                inserted.[ProductID]\n                ,inserted.[WorkOrderID]\n                ,'W'\n                ,GETDATE()\n                ,inserted.[OrderQty]\n            FROM inserted;\n        END;\n    END TRY\n    BEGIN CATCH\n        EXECUTE [dbo].[uspPrintError];\n\n        -- Rollback any active or uncommittable transactions before\n        -- inserting information in the ErrorLog\n        IF @@TRANCOUNT > 0\n        BEGIN\n            ROLLBACK TRANSACTION;\n        END\n\n        EXECUTE [dbo].[uspLogError];\n    END CATCH;\nEND;",
  "tableName": "WorkOrder"
}