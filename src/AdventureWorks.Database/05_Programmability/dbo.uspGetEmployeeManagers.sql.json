{
  "definitionName": "uspGetEmployeeManagers",
  "schemaName": "dbo",
  "definition": "CREATE PROCEDURE [dbo].[uspGetEmployeeManagers]\n@BusinessEntityID INT\nAS\nBEGIN\n    SET NOCOUNT ON;\n    WITH   [EMP_cte] ([BusinessEntityID], [OrganizationNode], [FirstName], [LastName], [JobTitle], [RecursionLevel])\n    AS     (SELECT\n                e.[BusinessEntityID],\n                e.[OrganizationNode],\n                p.[FirstName],\n                p.[LastName],\n                e.[JobTitle],\n                0\n            FROM  \n                [HumanResources].[Employee] AS e INNER JOIN\n                [Person].[Person] AS p ON\n                     p.[BusinessEntityID] = e.[BusinessEntityID] WHERE\n                                                                      e.[BusinessEntityID] = @BusinessEntityID\n            UNION ALL\n            SELECT\n                e.[BusinessEntityID],\n                e.[OrganizationNode],\n                p.[FirstName],\n                p.[LastName],\n                e.[JobTitle],\n                [RecursionLevel] + 1\n            FROM  \n                [HumanResources].[Employee] AS e INNER JOIN\n                [EMP_cte] ON\n                     e.[OrganizationNode] = [EMP_cte].[OrganizationNode].GetAncestor(1) INNER JOIN\n                [Person].[Person] AS p ON\n                     p.[BusinessEntityID] = e.[BusinessEntityID])\n    SELECT\n        [EMP_cte].[RecursionLevel],\n        [EMP_cte].[BusinessEntityID],\n        [EMP_cte].[FirstName],\n        [EMP_cte].[LastName],\n        [EMP_cte].[OrganizationNode].ToString() AS [OrganizationNode],\n        p.[FirstName] AS 'ManagerFirstName',\n        p.[LastName] AS 'ManagerLastName'\n    FROM  \n        [EMP_cte] INNER JOIN\n        [HumanResources].[Employee] AS e ON\n             [EMP_cte].[OrganizationNode].GetAncestor(1) = e.[OrganizationNode] INNER JOIN\n        [Person].[Person] AS p ON\n             p.[BusinessEntityID] = e.[BusinessEntityID] ORDER BY\n                                                              [RecursionLevel], [EMP_cte].[OrganizationNode].ToString()\n    OPTION (MAXRECURSION 25);\nEND",
  "xType": "P",
  "type": "PROCEDURE"
}